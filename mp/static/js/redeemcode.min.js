function Request(){this.protocol="http",this.host="test.bidongwifi.com",this.port="80",this.version="v0"}function redeemCode(){Request.call(this)}Vue.component("paginator",{template:'<div class="paginator">            <button type="button" class="btnWhiteSmall" v-on:click="pagePrev">上一页</button>            <span>{{ page }}</span> / <span>{{ total }}</span>            <button type="button" class="btnWhiteSmall" v-on:click="pageNext">下一页</button>            <input type="text"  v-model="jump" style="width:60px" placeholder="1" />            <button type="button" class="btnWhiteSmall" v-on:click="pageJump" style="width:60px">跳转</button>        </div>',props:["currentPage","totalPage","jumpPage"],data:function(){return{page:this.currentPage,total:this.totalPage,jump:this.jumpPage}},watch:{currentPage:function(a,b){this.page=a},totalPage:function(a,b){this.total=a},jumpPage:function(a,b){this.jump=a}},methods:{pagePrev:function(){return this.page-=1,this.page<1?(this.page=1,!1):void this.$emit("page-change",this.page)},pageNext:function(){return this.page+=1,this.page>this.total?(this.page=this.total,!1):void this.$emit("page-change",this.page)},pageJump:function(){this.jump>=1&&this.jump<=this.total&&(this.page=this.jump,this.$emit("page-change",this.page))}}}),Request.prototype._send=function(a,b,c,d,e){var f=b;$.ajax({method:a,url:f,dataType:"json",data:c}).done(function(a){console.log(a),200==parseInt(a.code)?$.isFunction(d)&&d(a):$.isFunction(e)?e(a):alert(a.reason)}).fail(function(a){console.log(a),alert("[请求失败]系统繁忙")})},Request.prototype._post=function(a,b,c,d){this._send("post",a,b,c,d)},Request.prototype._get=function(a,b,c,d){this._send("get",a,b,c,d)},redeemCode.prototype=new Request,redeemCode.prototype.createSerial=function(a,b,c,d){var e={count:a,hours:b,expired:c};this._post("/redeemcode/creation",JSON.stringify(e),function(a){d(a)})},redeemCode.prototype.generateCodes=function(a,b,c){var d={serial:a,page:b};this._get("/redeemcode/creation",d,function(a){c(a)})},redeemCode.prototype.getCodeList=function(a,b,c){var d={status:a,page:b};this._get("/redeemcode/list",d,function(a){c(a)})},redeemCode.prototype.getOperatorAndList=function(a,b,c,d,e){var f={start:a,end:b,operator:c,page:d};this._get("/redeemcode/operator",f,function(a){e(a)})},$(function(){$("#expired").datepicker({dateFormat:"yy-mm-dd",minDate:GetDateStr(0),onClose:function(a){vm.expired=a}});var a=new Clipboard("#clipboard");a.on("success",function(){return vm.codeList.length>0?void alert("本页兑换码已复制到剪贴板"):(alert("兑换码为空，请生成兑换码"),!1)}),a.on("error",function(){alert("[复制失败]")})});var renderList={template:"<tr><td>{{ code.code }}</td><td>{{ code.hours }}小时</td><td>至{{ code.expired }}</td></tr>",props:["code"]},ree=new redeemCode,vm=new Vue({el:"#redeemcode",data:{hours:1,count:1,expired:GetDateStr(1),codeList:[],currentPage:1,totalPage:1,jumpPage:"",serial:"",onePageCodes:""},components:{"render-list":renderList},computed:{totalExpired:function(){return this.expired+" 23:59:59"},exportCodes:function(){var a=""==this.serial?"javascript:;":"/redeemcode/codes.xls?serial="+this.serial;return a}},methods:{generateCodes:function(){var a=this;ree.createSerial(a.count,a.hours,a.totalExpired,function(b){a.serial=b.serial,a.pageChange(1),a.jumpPage=""})},pageChange:function(a){var b=this;ree.generateCodes(b.serial,a,function(a){b.renderClipboard(a.codes),b.currentPage=a.current_page,b.totalPage=a.total_pages,b.codeList=a.codes})},renderClipboard:function(a){for(var b=0,c="",d=a.length;b<d;b++){var e=a[b];c+=e.code+"\t"+e.hours+"小时\t有效期至"+e.expired+"\r\n"}this.onePageCodes=c},exportEXE:function(){var a=this;if(!(a.codeList.length>0))return alert("兑换码为空，请生成兑换码"),!1},checkCount:function(){var a=this;/^[1-9]$|^[1-9]\d$|^1\d{2}$|^200$/.test(a.count)||(a.count=1)}},watch:{count:function(a,b){/^[1-9]$|^[1-9]\d$|^1\d{2}$|^200$|^$/.test(a)||(this.count=1)}}});